(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3bdc6466"],{"18cf":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"c-library-drawer-doc-share"},[r("el-drawer",{attrs:{title:e.title,visible:e.visibleDrawer,"custom-class":"content-drawer",size:"400px","modal-append-to-body":!1},on:{"update:visible":function(t){e.visibleDrawer=t}}},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[r("el-scrollbar",{staticClass:"scrollbar"},[r("div",{staticClass:"content-drawer__content"},[r("el-form",{attrs:{model:e.shareInfo,"label-position":"top"}},[r("el-form-item",{attrs:{label:"分享名称"}},[r("el-input",{attrs:{maxlength:"32",placeholder:"请输入分享名称",autocomplete:"off",clearable:"","show-word-limit":""},model:{value:e.shareInfo.share_name,callback:function(t){e.$set(e.shareInfo,"share_name",t)},expression:"shareInfo.share_name"}})],1),r("el-form-item",[r("span",{attrs:{slot:"label"},slot:"label"},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"定义一个好记的分享码，为空时将随机生成！",placement:"top-start"}},[r("span",[e._v("个性化分享码 "),r("i",{staticClass:"el-icon-warning"})])])],1),r("el-input",{attrs:{minlength:"3",maxlength:"32",placeholder:"请输入个性化分享码，长度在3～32位",autocomplete:"off",clearable:"","show-word-limit":""},model:{value:e.shareInfo.share_code,callback:function(t){e.$set(e.shareInfo,"share_code",t)},expression:"shareInfo.share_code"}})],1),r("el-divider",[r("el-button",{staticClass:"more-options-btn",attrs:{type:"text",icon:e.moreOptionsOpen?"el-icon-arrow-up":"el-icon-arrow-down"},on:{click:e.onMoreOptions}},[e._v("\n                                更多参数\n                            ")])],1),r("el-collapse-transition",[r("div",{directives:[{name:"show",rawName:"v-show",value:e.moreOptionsOpen,expression:"moreOptionsOpen"}]},[r("el-form-item",{attrs:{label:"访问密码"}},[r("span",{attrs:{slot:"label"},slot:"label"},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"不设置访问密码将公开！",placement:"top-start"}},[r("span",[e._v("访问密码 "),r("i",{staticClass:"el-icon-warning"})])])],1),r("el-input",{attrs:{type:"password",maxlength:"32",placeholder:"请输入访问密码，长度在3～20位",autocomplete:"off",clearable:"","show-word-limit":"","show-password":""},model:{value:e.shareInfo.access_password,callback:function(t){e.$set(e.shareInfo,"access_password",t)},expression:"shareInfo.access_password"}})],1),r("el-form-item",{attrs:{label:"有效时间"}},[r("span",{attrs:{slot:"label"},slot:"label"},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"不设置有效时间将永久有效！",placement:"top-start"}},[r("span",[e._v("有效时间 "),r("i",{staticClass:"el-icon-warning"})])])],1),r("el-date-picker",{staticClass:"wd100",attrs:{"value-format":"timestamp",type:"datetime",placeholder:"选择有效时间",align:"right","picker-options":e.shareExpireTimeOptions},model:{value:e.shareInfo.expire_time,callback:function(t){e.$set(e.shareInfo,"expire_time",t)},expression:"shareInfo.expire_time"}})],1),r("el-form-item",{attrs:{label:"分享简介"}},[r("el-input",{attrs:{maxlength:"255",placeholder:"分享简介，1～255个字符之间",type:"textarea",rows:"3",resize:"none","show-word-limit":""},model:{value:e.shareInfo.share_desc,callback:function(t){e.$set(e.shareInfo,"share_desc",t)},expression:"shareInfo.share_desc"}})],1)],1)])],1)],1)]),e.shareInfo.id>0?r("el-alert",{attrs:{title:"修改过分享配置后，需要重新生成链接才生效！",type:"info",closable:!1,"show-icon":""}}):r("el-alert",{attrs:{title:"点击下方的 '生成分享' 来生成分享链接",type:"warning",closable:!1,"show-icon":""}}),r("div",{staticClass:"content-drawer__footer"},[r("el-input",{staticClass:"share-url-input",attrs:{value:e.shareUrl,placeholder:"点击下方的 '生成分享'",readonly:""}},[r("span",{attrs:{slot:"prepend"},slot:"prepend"},[r("i",{staticClass:"el-icon-share"}),e._v(" 分享地址")]),r("i",{directives:[{name:"clipboard",rawName:"v-clipboard",value:e.shareUrl,expression:"shareUrl"}],staticClass:"el-input__icon el-icon-document-copy",attrs:{slot:"suffix"},slot:"suffix"})]),r("div",{staticClass:"footer-optrate"},[e.shareInfo.id>0?r("el-button",{attrs:{type:"danger"},on:{click:e.onShareCancel}},[e._v("取消分享")]):e._e(),r("el-button",{attrs:{type:"primary",loading:e.shareLoading},on:{click:e.onShare}},[e._v("\n                        "+e._s(e.shareInfo.id>0?"重新生成分享":"生成分享")+"\n                    ")])],1)],1)],1)])],1)},i=[],a=(r("8e6e"),r("ac6a"),r("456d"),r("96cf"),r("3b8d")),s=r("bd86"),o=r("cc2f"),c=r("5710"),l=r("2f62"),p=r("9565");function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){Object(s["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d={id:0,share_code:"",share_name:"",share_desc:"",access_password:"",access_count:0,expire_time:""},f={name:"c-library-drawer-doc-share",mixins:[o["a"],c["a"]],computed:h(h({},Object(l["b"])("userSession",["userInfo"])),{},{title:function(){return"文档分享"},shareUrl:function(){return this.shareInfo.share_code?Object(p["a"])(this.shareInfo.share_code):""}}),data:function(){return{docId:0,moreOptionsOpen:!1,shareInfo:h({},d),loading:!1,shareLoading:!1,shareExpireTimeOptions:{shortcuts:[{text:"在一小时内",onClick:function(e){var t=new Date;t.setTime(t.getTime()+36e5),e.$emit("pick",t)}},{text:"仅当天",onClick:function(e){e.$emit("pick",new Date((new Date).toLocaleDateString()).getTime()+864e5-1)}},{text:"在一天内",onClick:function(e){var t=new Date;t.setTime(t.getTime()+864e5),e.$emit("pick",t)}},{text:"在一周内",onClick:function(e){var t=new Date;t.setTime(t.getTime()+6048e5),e.$emit("pick",t)}},{text:"在一月内",onClick:function(e){var t=new Date;t.setTime(t.getTime()+2592e6),e.$emit("pick",t)}}]}}},methods:{initEventBus:function(e){var t=this;e.$on("doc-will-share",(function(e){var r=e.docId;t.docId=r,t.visibleDrawer=!0}))},initShareInfo:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return d.share_name=this.generateShareName(),this.shareInfo=h({},d),t={library_id:this.libraryId,library_doc_id:this.docId},e.next=5,this.$api.v1.LibraryMemberDocShareInfo(t,{loading:function(e){r.loading=e},report:!0}).then((function(e){var t=e.resData;t.expire_time=t.expire_time?1e3*t.expire_time:"",r.shareInfo=t})).catch((function(){}));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),generateShareName:function(){return this.$utils.DateFormat(Date.now()/1e3,"m-d H:i")+" 来自「".concat(this.userInfo.nickname.substr(0,13),"」的分享")},onDrawerOpen:function(){this.initShareInfo()},onMoreOptions:function(){this.moreOptionsOpen=!this.moreOptionsOpen},onShare:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.$utils.CloneDeep(this.shareInfo),t.library_id=this.libraryId,t.library_doc_id=this.docId,t.expire_time=t.expire_time?t.expire_time/1e3>>0:0,e.next=6,this.$api.v1.LibraryMemberDocShare(t,{loading:function(e){r.shareLoading=e}}).then((function(e){var t=e.resData;t.expire_time=t.expire_time?1e3*t.expire_time:"",r.shareInfo=t,r.$tip.success("生成分享成功！")}));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onShareCancel:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={library_id:this.libraryId,library_doc_id:this.docId},e.next=3,this.$api.v1.LibraryMemberDocShareCancel(t,{loading:function(e){r.shareLoading=e}}).then((function(e){e.resData;r.$tip.success("取消分享成功！"),r.visibleDrawer=!1}));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},m=f,b=(r("19d1"),r("2877")),w=Object(b["a"])(m,n,i,!1,null,null,null);t["default"]=w.exports},"19d1":function(e,t,r){"use strict";var n=r("5f87"),i=r.n(n);i.a},5710:function(e,t,r){"use strict";r("96cf");var n=r("3b8d"),i=r("6c47");t["a"]={mixins:[i["a"]],inject:["libraryContentEventBus"],watch:{libraryId:{handler:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t>0)){e.next=5;break}if(e.t0=this.initComponent,!e.t0){e.next=5;break}return e.next=5,this.initComponent();case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),immediate:!0}},created:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.initEventBus&&this.initEventBus(this.libraryContentEventBus);case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{initEventBus:function(e){},initComponent:function(){}}}},"5f87":function(e,t,r){},9565:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("bceb"),i=function(e){return Object(n["d"])("/library/preview",{code:e})}},cc2f:function(e,t,r){"use strict";t["a"]={props:{visible:{type:Boolean,default:!1}},watch:{visible:function(e){this.visibleDrawer=e},visibleDrawer:function(e){this.$emit("update:visible",e),e?this.onDrawerOpen&&this.onDrawerOpen():this.$emit("close",this.$data)}},data:function(){return{visibleDrawer:this.visible,loadingDrawer:!1}}}}}]);